三次样条插值（Cubic Spline Interpolation）
### 基本概念
- 三次样条插值（Cubic Spline Interpolation），简称Spline插值，是一种通过一系列形值点（样本点）构造出一条光滑曲线的数学方法。

三次样条插值是通过求解三弯矩方程组得出曲线函数组的过程。在区间[a, b]上，给定n+1个样本点$[(x_0, y_0), (x_1, y_1), ..., (x_n, y_n)]$，其中$[a = x_0 < x_1 < , ..., < x_n = b]$，三次样条插值函数S(x)需要满足以下条件：

1. **在每个小区间[$ x_i, x_{i+1} $]上，S(x)都是一个三次多项式**。
2. **S(x)在整个区间[a, b]上连续且光滑，即其一阶导数S′(x)和二阶导数S″(x)都存在且连续**。
3. **S(x)经过所有给定的数据点，即$S(x_i) = y_i$, i = 0, 1, ..., n**。

### 求解过程

#### 1. 构造三次多项式(以小片段函数反求完整函数)

在每个小区间$[x_i, x_{i+1}]$上，插值函数S(x)可以表示为：

$S_i(x) = a_i + b_i(x - x_i) + c_i(x - x_i)^2 + d_i(x - x_i)^3$

其中，$ a_i, b_i, c_i, d_i $是待求的系数。

#### 2. 插值条件

根据插值条件，我们有：

$ S_i(x_i) = y_i $

这给出了n+1个方程。

#### 3. 连续性条件

曲线在整个区间[a, b]上连续，表明在端点$ x_i $（i = 1, 2, ..., n-1）处两边函数值相等，即：

$ S_{i-1}(x_i) = S_i(x_i) $

这给出了n-1个方程。

#### 4. 光滑性条件

曲线在整个区间[a, b]上光滑，表明在端点$x_i$（i = 1, 2, ..., n-1）两边的一阶导数和二阶导数存在且相等，即：

$ S_{i-1}^{\prime}(x_i) = S_i^{\prime}(x_i) $
$ S_{i-1}^{\prime\prime}(x_i) = S_i^{\prime\prime}(x_i) $

这给出了2(n-1)个方程。

#### 5. 边界条件

由于上述条件只能给出4n-2个方程，而我们需要求解4n个未知数（每个小区间4个系数，共n个小区间），因此还需要两个边界条件。常见的边界条件有三种：

- **自然边界**：指定端点二阶导数为0，即$ S^{\prime\prime}_0(x_0) = S^{\prime\prime}_{n-1}(x_n) = 0$。
- **固定边界**：人为指定端点一阶导数，即$ S^{\prime}_0(x_0) = A, S^{\prime}_{n-1}(x_n) = B $。
- **非扭结边界**：强制第一个插值点的三阶导数值等于第二个点的三阶导数值，最后第一个点的三阶导数值等于倒数第二个点的三阶导数值，即$ S^{\prime\prime\prime}_0(x_0) = S^{\prime\prime\prime}_1(x_1), S^{\prime\prime\prime}_{n-2}(x_{n-1}) = S^{\prime\prime\prime}_{n-1}(x_n) $。

#### 6. 解方程组

将上述所有条件组合成线性方程组，并求解该方程组，得到所有系数$ a_i, b_i, c_i, d_i $。

#### 7. 构造插值函数

利用求得的系数，构造出整个区间[a, b]上的三次样条插值函数S(x)。

